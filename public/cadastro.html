<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="icon" type="image/x-icon" href="assets/utilidades/icons/favicon.png" />
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/cadastro.css">
</head>

<body>
    <section class="section-login">
        <div class="container">

            <div class="sign-page">
                <header>
                    <a href="index.html" class="logo"></a>
                </header>
                <div class="login-wrapper">
                    <h1 class="title">Cadastre-se</h1>
                    <div class="form">
                        <div class="input-wrapper">
                            <p>Email</p>
                            <input id="input_email" type="text">
                        </div>
                        <div class="input-wrapper">
                            <p>Confirme o email</p>
                            <input id="input_confirmarEmail" type="text">
                        </div>
                        <div class="input-wrapper">
                            <p>Senha</p>
                            <input id="input_senha" type="text">
                        </div>
                        <div class="input-wrapper">
                            <p>Confirme a Senha</p>
                            <input id="input_confirmarSenha" type="text">
                        </div>
                    </div>
                    <div class="btn-wrapper">
                        <button onclick="cadastrar()" class="btn-green">Cadastre-se</button>
                        <a class="btn-white" href="login.html">Já tem conta?<strong> Entre</strong></a>
                    </div>
                </div>
            </div>
            <div class="right-img"></div>
        </div>
    </section>
</body>

</html>

<script>
    function cadastrar() {
       // var empresaVar = input_nomeEmpresa.value;
       // var telefoneVar = input_telefone.value
       // var nomeVar = input_nome.value;
        var emailVar = input_email.value;
        var confirmacaoEmailVar = input_confirmarEmail.value
        var senhaVar = input_senha.value;
        var confirmacaoSenhaVar = input_confirmarSenha.value;

       // if (empresaVar == "" || nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "") {
       //    console.log = "(Preencha todos os campos)";
      //      return false;
       // }

        if (emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "" || confirmacaoEmailVar == "") {
           console.log = "(Preencha todos os campos)";
            return false;
        }

      //  if (nomeVar.length < 1) {
        //   console.log = "(Preencha o campo Nome)";
          //  return false;
        //}

       // if (telefoneVar.length < 1) {
         //  console.log = "(Preencha o campo Nome)";
           // return false;
        //}

        // validação de @ no email
        if (emailVar.indexOf('@') == -1) {
           console.log = "(E-mail inválido)";
            return false;
        }

        if (senhaVar.length < 6) {
           console.log = "(Senha deve conter no mínimo 6 caracteres)";
            return false;
        }

        if (emailVar != confirmacaoEmailVar) {
           console.log = "(E-mails não coincidem)";
            return false;
        }

        if (senhaVar != confirmacaoSenhaVar) {
           console.log = "(Senhas não coincidem)";
            return false;
        }

        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
              // nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar
              //  empresaServer: empresaVar,
              // telefoneServer: telefoneVar
            })
        }).then(function (resposta) {
            if (resposta.ok) {
               console.log = "Cadastro realizado com sucesso!";
                setTimeout(() => {
                    window.location = "login.html";
                }, 2000);
            } else {
                resposta.text().then(texto => {
                   console.log = texto;
                });
            }
        }).catch(function (erro) {
            console.log(erro);
        });

        return false;
    }


    function validarSessao() {
        var email = sessionStorage.EMAIL_USUARIO;
       // var nome = sessionStorage.NOME_USUARIO;
       //var empresa = sessionStorage.EMPRESA_USUARIO;
        var id = sessionStorage.ID_USUARIO

        var b_usuario = document.getElementById("b_usuario");
        var b_empresa = document.getElementById("b_empresa");

        if (email != null && nome != null) {
            b_usuario.innerHTML = nome;
            b_empresa.innerHTML = empresa;
        } else {
            window.location = "login.html";
        }
    }

    function limparSessao() {
        sessionStorage.clear();
        window.location = "login.html";
    }

    // carregamento (loading)
    function aguardar() {
        var divAguardar = document.getElementById("div_aguardar");
        divAguardar.style.display = "flex";
    }

    function finalizarAguardar(texto) {
        var divAguardar = document.getElementById("div_aguardar");
        divAguardar.style.display = "none";

        var divErrosLogin = document.getElementById("div_erros_login");
        if (texto) {
            divErrosLogin.style.display = "flex";
            divErrosLogin.innerHTML = texto;
        }
    }
</script>